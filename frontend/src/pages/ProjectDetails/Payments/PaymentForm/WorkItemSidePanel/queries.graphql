query SearchIssues($projectId: uuid!, $authorId: bigint!, $createdSince: timestamp!) {
  projectsByPk(id: $projectId) {
    id
    githubRepos {
      projectId
      githubRepoId
      repoIssues(where: { authorId: { _eq: $authorId }, createdAt: { _gte: $createdSince } }) {
        ...GithubIssueDetails
      }
    }
  }
}

fragment RepositoryOwnerAndName on Repo {
  id
  owner
  name
}

query getPaidWorkItems($projectId: uuid!) {
  projectsByPk(id: $projectId) {
    id
    githubRepos {
      projectId
      githubRepoId
      githubRepoDetails {
        id
        content {
          ...RepositoryOwnerAndName
        }
      }
    }
    budgets {
      id
      paymentRequests {
        id
        workItems {
          paymentId
          repoId
          issueNumber
        }
      }
    }
  }
}

query fetchIssue($repoOwner: String!, $repoName: String!, $issueNumber: Int!) {
  fetchIssue(repoOwner: $repoOwner, repoName: $repoName, issueNumber: $issueNumber) {
    ...IssueDetails
  }
}

query GetProjectRepos($projectId: uuid!) {
  projectsByPk(id: $projectId) {
    id
    githubRepos {
      projectId
      githubRepoId
      githubRepoDetails {
        id
        content {
          ...RepositoryOwnerAndName
        }
      }
    }
  }
}

mutation CreateIssue($projectId: Uuid!, $githubRepoId: Int!, $title: String!, $description: String!) {
  createIssue(projectId: $projectId, githubRepoId: $githubRepoId, title: $title, description: $description) {
    ...IssueDetails
  }
}
